# Тестовое задание
В данной задаче в рамках тестового задания необходимо построить сквозную аналитику для салона красоты. У салона есть реклама в онлайне и сайт, через который можно оставить заявку на услугу. 

При помощи сквозной аналитики нужно проследить путь от клика по рекламному объявлению до покупки и, таким образом, оценить эффективность маркетинга. 
Клик по рекламе трансформируется в лид (заявку), а лид превращается в клиента, который уже может совершить некоторое количество покупок.
Необходимо подготовить данные для отчета по сквозной аналитике. Для решения можно использовать на выбор: SQL или Python (Pandas). 
Данные поступают на вход в виде 3 csv файлов:

* ads.csv
* leads.csv
* purchases.csv

### Связи
Связь между рекламой и заявкой определяется через utm метки - если набор меток из рекламного объявления совпадает с тем набором, который есть в заявке, то мы можем определить сколько денег было потрачено на привлечение этого лида. 
Связь между лидом и продажами определяется через client_id.

### Атрибуция лид - покупка
Каждому лиду “в зачет” идут только те покупки, которые клиент сделал в первые 15 дней после создания заявки. Из-за особенности бизнеса соотношение лидов и продаж - многие ко многим. Существующий клиент может купить услугу повторно через заведение новой заявки, а может создать две заявки подряд и после этого сделать покупку.

### Чтобы однозначно атрибутировать продажи к лидам мы подготовили примеры:
1. У клиента несколько лидов подряд, а затем продажа. Продажа засчитывается последнему лиду, который был создан не позже, чем 15 дней до.
2. У клиента несколько лидов подряд, а затем продажа. Продажа не засчитывается ни одному лиду, тк была создана позже 15 дней после последнего лида.
3. У клиента несколько лидов подряд, а затем продажа. Продажа засчитывается последнему лиду, который был создан не позже, чем 15 дней до.
4. У клиента несколько лидов и продаж вперемешку. Каждая продажа засчитывается ближайшему по времени лиду.
